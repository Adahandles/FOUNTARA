<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fountara — Water & Sod • Pay with WTR / ADA</title>

<!-- Social preview -->
<meta property="og:title" content="Fountara — Water & Sod • Pay with WTR / ADA" />
<meta property="og:description" content="Order potable bulk water or sod. Reserve Water Bank storage by gallon or by case. Pay with Water Token (WTR) or ADA on Cardano." />
<!-- Updated: og:image now points to the relocated asset in assets/img -->
<meta property="og:image" content="assets/img/wtrcoin.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Fountara — Water & Sod" />
<meta name="twitter:description" content="Reserve storage & schedule delivery. Pay with WTR / ADA." />
<!-- Updated: twitter:image now points to the relocated asset -->
<meta name="twitter:image" content="assets/img/wtrcoin.png" />

<link rel="icon" href="./Flogo.jpg" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />

<style>
:root{
  --bg1:#001018;--bg2:#00243a;--bg3:#0b1930;
  --cyan:#6cf;--cyan2:#8cf;--txt:#eaf1fb;--muted:#a7b6c7;--card:rgba(0,0,0,.25)
}
*{box-sizing:border-box}
body{
  margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:var(--txt);
  background:linear-gradient(270deg,var(--bg1),var(--bg2),var(--bg3),var(--bg1));
  background-size:600% 600%;animation:aurora 22s ease infinite;overflow-x:hidden
}
@keyframes aurora{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
.wrap{max-width:1100px;margin:0 auto;padding:2rem 1rem}
.section-title{font-size:clamp(1.9rem,3vw,2.6rem);margin:0 0 .8rem}
.muted{color:var(--muted)}
.token-box{background:var(--card);border:1px solid #ffffff22;border-radius:16px;padding:1rem;margin-bottom:1rem;box-shadow:0 0 18px rgba(108,207,255,.15)}
.card{background:var(--card);border:1px solid #ffffff22;border-radius:14px;padding:1rem;box-shadow:0 0 18px rgba(108,207,255,.15)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
.grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
@media(max-width:920px){.grid2,.grid3{grid-template-columns:1fr}}
.input{width:100%;padding:.8rem;border:1px solid #ffffff2a;background:#0005;color:#fff;border-radius:12px}
label{font-weight:600;font-size:.95rem}
.small{font-size:.9rem}
.kv{display:flex;justify-content:space-between;gap:.5rem}
.flex{display:flex;gap:.6rem;flex-wrap:wrap}
.center{display:flex;justify-content:center;align-items:center}

/* Buttons & Tabs */
.btn{
  display:inline-flex;align-items:center;justify-content:center;
  padding:1rem 1.5rem;border-radius:14px;border:2px solid var(--cyan2);
  background:linear-gradient(180deg,rgba(108,207,255,.25),rgba(108,207,255,.1));
  color:#fff;font-weight:600;font-size:1rem;letter-spacing:.4px;
  box-shadow:0 0 22px rgba(108,207,255,.35);cursor:pointer;transition:all .25s ease
}
.btn:hover{background:linear-gradient(180deg,rgba(108,207,255,.4),rgba(108,207,255,.2));box-shadow:0 0 32px rgba(108,207,255,.55);transform:translateY(-1px)}
.btn.secondary{border-color:#fff4;background:linear-gradient(180deg,rgba(255,255,255,.1),rgba(255,255,255,.05));color:#fff}
.btn.secondary:hover{box-shadow:0 0 26px rgba(255,255,255,.35)}
.tab{color:#fff;font-weight:600;background:rgba(255,255,255,.08);border-radius:12px;border:1px solid #ffffff33;padding:.6rem 1rem;cursor:pointer;transition:all .2s ease}
.tab:hover,.tab.active{background:rgba(255,255,255,.18);box-shadow:0 0 18px rgba(108,207,255,.4)}

/* Hero */
header.hero{min-height:62vh;display:grid;place-items:center;text-align:center;padding:4rem 1rem 2rem}
.hero-inner{max-width:960px}
.logo{width:340px;height:340px;border-radius:50%;object-fit:cover;border:3px solid #fff;box-shadow:0 0 26px var(--cyan2);transition:transform .4s ease, box-shadow .4s ease;animation:pulse 3.2s ease infinite}
.logo:hover{transform:scale(1.03) rotate(2deg);box-shadow:0 0 60px var(--cyan)}
@keyframes pulse{0%{transform:scale(1);box-shadow:0 0 18px rgba(108,207,255,.15)}50%{transform:scale(1.03);box-shadow:0 0 36px rgba(108,207,255,.15)}100%{transform:scale(1);box-shadow:0 0 18px rgba(108,207,255,.15)}}
h1{font-size:clamp(2.3rem,4vw,3.4rem);margin:.8rem 0 .4rem}
.tag{color:var(--muted);font-size:1.05rem;margin:0 auto 1.1rem;max-width:720px}

/* Copy pill + footer */
.copy{padding:.35rem .55rem;border-radius:9px;border:1px solid #ffffff33;background:#ffffff1a;color:#fff;cursor:pointer}
footer{color:var(--muted);text-align:center;padding:2rem 1rem}
</style>
</head>
<body>

<!-- HERO -->
<header class="hero">
  <div class="hero-inner">
    <!-- Updated: logo src now references assets/img/wtrcoin.png -->
    <img class="logo" src="assets/img/wtrcoin.png" alt="Water Token (WTR) coin" />
    <h1>Fountara</h1>
    <p class="tag">Potable water & farm-fresh sod. Reserve <strong>Water Bank</strong> storage & schedule delivery. Pay with <strong>WTR</strong> or <strong>ADA</strong>.</p>
    <div class="flex center">
      <a href="#order" class="btn">Start Order</a>
      <a href="#waterbank" class="btn">Water Bank</a>
      <a href="#pay" class="btn">Checkout</a>
      <a href="tokenomics.html" class="btn secondary">Tokenomics</a>
      <a href="stake.html" class="btn secondary">Stake</a>
      <a href="bond.html" class="btn secondary">Bond</a>
      <a href="earn.html" class="btn secondary">Earn</a>
      <a href="orange-springs-overview.html" class="btn secondary">Orange Springs</a>
    </div>
  </div>
</header>

<!-- BRAND STRIP -->
<section class="wrap" style="padding-top:0">
  <div class="token-box" style="display:grid;grid-template-columns:1.2fr .8fr;gap:1rem;align-items:center">
    <div>
      <img src="./Flogo.jpg" alt="Fountara Spring Water" style="height:72px;object-fit:contain;filter:drop-shadow(0 0 8px rgba(108,207,255,.25))" />
      <p class="muted" style="margin:.6rem 0 0">Florida-built, nationwide vision: water logistics + Water Bank reserves. Crypto-friendly via WTR / ADA.</p>
    </div>
    <div style="display:flex;gap:.6rem;justify-content:flex-end;flex-wrap:wrap">
      <img src="./watertanker.png" alt="Water tanker" style="height:100px;border-radius:12px;border:1px solid #ffffff22" />
      <img src="./Sodtruck.png" alt="Sod delivery" style="height:100px;border-radius:12px;border:1px solid #ffffff22" />
    </div>
  </div>
</section>

<!-- ORDER SECTION -->
<div class="wrap" id="order">
  <h2 class="section-title">Order Water or Sod</h2>
  <div class="grid2">
    <div class="card">
      <label>Product</label>
      <select class="input" id="product">
        <option value="water">Bulk Potable Water</option>
        <option value="sod">Farm-fresh Sod</option>
      </select>
      <div class="kv small" style="margin-top:.8rem">
        <span>Tank / Pallets</span>
        <input class="input" id="qty" type="number" min="1" value="1" />
      </div>
      <div class="kv small" style="margin-top:.8rem">
        <span>Delivery distance (miles)</span>
        <input class="input" id="miles" type="number" min="0" value="10" />
      </div>
      <div class="flex" style="margin-top:1rem">
        <button class="btn" onclick="addToCart()">Add to Cart</button>
      </div>
    </div>
    <div class="card" id="quote">
      <h3 style="margin-top:0">Live Quote</h3>
      <div class="small muted">Estimates update as you change inputs.</div>
      <div id="quoteOut" style="margin-top:.8rem"></div>
    </div>
  </div>
</div>

<!-- WATERBANK SECTION -->
<div class="wrap" id="waterbank">
  <h2 class="section-title">Water Bank</h2>
  <div class="card">
    <p class="small">Reserve storage by entering the number of gallons. Convert reservations to deliveries any time.</p>
    <!-- New input fields for Water Bank reservations -->
    <div class="grid2">
      <label>Gallons to Reserve
        <input id="reserve_gal" class="input" type="number" placeholder="Gallons" min="1" />
      </label>
      <label>Bank Branch
        <select id="bank_branch" class="input">
          <option value="orange">Orange Springs Bank</option>
          <option value="black">Black Sink Bank</option>
          <option value="moss">Moss Bluff Bank</option>
        </select>
      </label>
    </div>
    <div class="grid2" style="margin-top:1rem">
      <label>Water Bank Action
        <select id="wb_action" class="input" onchange="toggleDestination()">
          <option value="pickup">Pickup (customer pickup)</option>
          <option value="delivery">Delivery (by Fountara)</option>
        </select>
      </label>
      <label id="dest_label" style="display:none;">Destination Address
        <input id="wb_destination" class="input" type="text" placeholder="Delivery address or location" />
      </label>
    </div>
    <div class="flex" style="margin-top:1rem">
      <button class="btn secondary" onclick="reserve()">Reserve</button>
    </div>
    <!-- Display distance and token reward -->
    <div id="wb_info" class="small" style="margin-top:0.5rem;color:var(--muted)"></div>
  </div>
  <!-- Reserves summary -->
  <div class="card" style="margin-top:1rem;">
    <h3>My Water Bank Reserves</h3>
    <div class="kv"><span class="muted">Gallons Reserved</span><strong id="wb_reserved_gal">0</strong></div>
    <div class="kv"><span class="muted">Cases Reserved</span><strong id="wb_reserved_cases">0</strong></div>
    <div class="kv"><span class="muted">Tankers Reserved</span><strong id="wb_reserved_tankers">0</strong></div>
    <div class="kv"><span class="muted">Delivery Credit (USD)</span><strong id="wb_reserved_credit">$0.00</strong></div>
    <div class="kv"><span class="muted">Withdraw Rights Reserves</span><strong id="wb_withdraw_rights">0</strong></div>
    <div class="kv"><span class="muted">Bagged &amp; Cans Reserves</span><strong id="wb_bagged_cans">0</strong></div>
  </div>
</div>

<!-- CHECKOUT SECTION -->
<div class="wrap" id="pay">
  <h2 class="section-title">Checkout • WTR / ADA</h2>
  <div class="grid2">
    <div class="card">
      <label>Pay with</label>
      <div class="flex" style="margin-top:.5rem">
        <button class="btn" onclick="setPay('WTR')">Water Token (WTR)</button>
        <button class="btn" onclick="setPay('ADA')">ADA</button>
      </div>
      <p class="small muted" style="margin-top:.8rem">Handles supported: <strong>$Waterpay</strong>, <strong>$homeyield</strong>.</p>
      <!-- New payment method selector -->
      <label style="display:block;margin-top:.8rem">Payment Method
        <select id="paymentMethod" class="input">
          <option value="echk">Bank eCheck</option>
          <option value="card">Credit / Debit Card</option>
          <option value="venmo">Venmo</option>
          <option value="paypal">PayPal</option>
          <option value="cashapp">Cash App</option>
          <option value="chime">Chime</option>
          <option value="anycrypto">Any Crypto (auto-swap to ADA)</option>
        </select>
      </label>
    </div>
    <div class="card">
      <h3 style="margin-top:0">Cart</h3>
      <div id="cartOut" class="small"></div>
      <div class="flex" style="margin-top:1rem">
        <button class="btn">Generate Payment QR</button>
        <button class="btn secondary">Save Quote</button>
      </div>
    </div>
  </div>
</div>

<script>
let pay='WTR', cart=[];
// Track reserves
let reserved_gal=0, reserved_cases=0, reserved_tankers=0, reserved_credit=0;
let reserved_rights=0, reserved_bagged_cans=0; // new counters for rights and bagged/cans
// Payment method variable
let paymentMethod='echk';
function price(product, qty, miles){
  const base = product==='water' ? 180 : 220;        // example per-unit baseline
  const haul = Math.max(0, miles)*3.5;               // per-mile
  return Math.round((base*qty + haul)*100)/100;
}
function renderQuote(){
  const p=document.getElementById('product').value;
  const q=+document.getElementById('qty').value||1;
  const m=+document.getElementById('miles').value||0;
  const total=price(p,q,m);
  document.getElementById('quoteOut').innerHTML =
    `<div class="kv"><span>Product</span><strong>${p}</strong></div>
     <div class="kv"><span>Quantity</span><strong>${q}</strong></div>
     <div class="kv"><span>Miles</span><strong>${m}</strong></div>
     <hr style="border-color:#ffffff22">
     <div class="kv"><span>Total Estimate</span><strong>${total} USD eq.</strong></div>`;
}
function addToCart(){
  const p=document.getElementById('product').value;
  const q=+document.getElementById('qty').value||1;
  const m=+document.getElementById('miles').value||0;
  cart.push({p,q,m,t:price(p,q,m)});
  renderCart();
}
function renderCart(){
  if(!cart.length){document.getElementById('cartOut').innerHTML='Empty';return;}
  document.getElementById('cartOut').innerHTML = cart.map((it,i)=>
    `${i+1}. ${it.p} ×${it.q} • ${it.m} mi — <strong>${it.t}</strong>`
  ).join('<br>');
}
function setPay(x){pay=x;}
// Show or hide destination field based on action selection
function toggleDestination(){
  const action=document.getElementById('wb_action') ? document.getElementById('wb_action').value : '';
  const label=document.getElementById('dest_label');
  if(label){
    label.style.display = action === 'delivery' ? '' : 'none';
  }
}

// Fetch coordinates for an address using Nominatim (may require User-Agent)
async function getCoordinates(address){
  try {
    const url='https://nominatim.openstreetmap.org/search?format=json&limit=1&q='+encodeURIComponent(address);
    const res=await fetch(url, { headers: { 'User-Agent': 'Mozilla/5.0' }});
    const data=await res.json();
    if(data && data.length>0){
      return { lat: parseFloat(data[0].lat), lon: parseFloat(data[0].lon) };
    }
  } catch(err){}
  return null;
}

// Compute distance between two lat/lon points using the haversine formula (miles)
function haversineDistance(lat1, lon1, lat2, lon2){
  const R=3958.8; // Earth radius in miles
  const dLat=(lat2-lat1) * Math.PI / 180;
  const dLon=(lon2-lon1) * Math.PI / 180;
  const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)**2;
  const c=2*Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  return R*c;
}

// Calculate round-trip distance from Orange Springs, FL to a destination
async function calculateDistance(address){
  const coords=await getCoordinates(address);
  if(!coords){ return null; }
  const ORANGE_LAT=29.5060816;
  const ORANGE_LON=-81.9453664;
  const d=haversineDistance(ORANGE_LAT, ORANGE_LON, coords.lat, coords.lon);
  return d*2;
}
async function reserve(){
  // get number of gallons from input
  const gInput=document.getElementById('reserve_gal');
  const g= gInput ? parseFloat(gInput.value) : null;
  if(!g || g <= 0){ alert('Please enter a valid number of gallons.'); return; }
  const branch=document.getElementById('bank_branch') ? document.getElementById('bank_branch').value : '';
  const actionSelect=document.getElementById('wb_action');
  const action=actionSelect ? actionSelect.value : '';
  const dest=document.getElementById('wb_destination') ? document.getElementById('wb_destination').value.trim() : '';

  // Build description
  let desc=`Reserve ${g} gal @ ${branch}`;
  if(action === 'delivery' && dest){ desc+=` to ${dest}`; }
  desc+=` (${action})`;

  // update reserves counters
  reserved_gal += g;
  reserved_rights += g;
  // categorize cases vs tankers based on amount
  if(g >= 5000){
    reserved_tankers += 1;
  } else {
    reserved_cases += 1;
  }
  // update bagged & cans: treat each reservation as one bagged & cans entry
  reserved_bagged_cans += 1;
  reserved_credit += g * 0.05;

  // update DOM reserves
  const galEl=document.getElementById('wb_reserved_gal');
  const casesEl=document.getElementById('wb_reserved_cases');
  const tankEl=document.getElementById('wb_reserved_tankers');
  const creditEl=document.getElementById('wb_reserved_credit');
  const rightsEl=document.getElementById('wb_withdraw_rights');
  const baggedEl=document.getElementById('wb_bagged_cans');
  if(galEl) galEl.textContent = reserved_gal;
  if(casesEl) casesEl.textContent = reserved_cases;
  if(tankEl) tankEl.textContent = reserved_tankers;
  if(creditEl) creditEl.textContent = `$${reserved_credit.toFixed(2)}`;
  if(rightsEl) rightsEl.textContent = reserved_rights;
  if(baggedEl) baggedEl.textContent = reserved_bagged_cans;

  // Calculate WRE reward: 0.0001 WRE per 100 gallons
  const wre = (g / 100) * 0.0001;

  // Update information panel with tokens and distance (if applicable)
  const infoEl=document.getElementById('wb_info');
  if(infoEl) {
    infoEl.innerHTML = `WRE reward: <strong>${wre.toFixed(6)} WRE</strong>`;
  }

  // If delivery, calculate distance
  if(action === 'delivery' && dest){
    const dist = await calculateDistance(dest);
    if(dist !== null && infoEl){
      infoEl.innerHTML += `<br/>Approx. round trip distance: <strong>${dist.toFixed(2)} mi</strong>`;
    }
  }

  // Add to cart (reflect cost as credit only)
  cart.push({p:desc,q:1,m:0,t:g*0.05});
  renderCart();
}
['product','qty','miles'].forEach(id=>document.getElementById(id).addEventListener('input',renderQuote));
renderQuote();
// Initialize destination visibility on page load
toggleDestination();
</script>

<!-- Listener for payment method dropdown -->
<script>
const pmEl = document.getElementById('paymentMethod');
if (pmEl) {
  pmEl.addEventListener('change', function(){
    paymentMethod = this.value;
  });
}
</script>

<!-- Verified on Cardano Footer -->
<footer style="color:var(--muted);text-align:center;padding:2rem 1rem">
  <div>Fountara • info@fountara.com</div>
  <div style="margin-top:0.5rem">
    <strong style="color:var(--cyan2)">Verified on Cardano</strong><br/>
    Policy ID: 7e159ba1d6ef752b5f3ba12a97f3b46a9706687b233341cc5f83d33b<br/>
    Fingerprint: asset1npw022evzyjh6xlz0cydt8qsa5ctplxnwuhxc2
  </div>
</footer>

</body>
</html>
