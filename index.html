<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fountara — Buy Bulk Water or Sod with Crypto (WTR / ADA)</title>

<!-- Social preview -->
<meta property="og:title" content="Fountara — Bulk Water & Sod • Pay with WTR or ADA" />
<meta property="og:description" content="Order bulk potable water tanker loads or sod pallets. Checkout with Water Token (WTR) or ADA on Cardano." />
<meta property="og:image" content="./wtrcoin.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Fountara — Bulk Water & Sod" />
<meta name="twitter:description" content="Pay with Water Token (WTR) or ADA." />
<meta name="twitter:image" content="./wtrcoin.png" />

<link rel="icon" href="./Flogo.jpg" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />

<style>
:root{
  --bg1:#001018;--bg2:#00243a;--bg3:#0b1930;
  --cyan:#6cf;--cyan2:#8cf;--txt:#eaf1fb;--muted:#a7b6c7;--card:rgba(0,0,0,.25)
}
*{box-sizing:border-box}
body{
  margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:var(--txt);
  background:linear-gradient(270deg,var(--bg1),var(--bg2),var(--bg3),var(--bg1));
  background-size:600% 600%;animation:aurora 22s ease infinite;
  overflow-x:hidden
}
@keyframes aurora{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
.wrap{max-width:1100px;margin:0 auto;padding:2rem 1rem}
.section-title{font-size:clamp(1.9rem,3vw,2.6rem);margin:0 0 .8rem}
.muted{color:var(--muted)}
.token-box{background:var(--card);border:1px solid #ffffff22;border-radius:16px;padding:1rem;margin-bottom:1rem;box-shadow:0 0 18px rgba(108,207,255,.15)}
.card{background:var(--card);border:1px solid #ffffff22;border-radius:14px;padding:1rem;box-shadow:0 0 18px rgba(108,207,255,.15)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
.grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
@media(max-width:920px){.grid2,.grid3{grid-template-columns:1fr}}
.input{width:100%;padding:.8rem;border:1px solid #ffffff2a;background:#0005;color:#fff;border-radius:12px}
label{font-weight:600;font-size:.95rem}
.small{font-size:.9rem}
.kv{display:flex;justify-content:space-between;gap:.5rem}
.kv strong{font-weight:600}
.flex{display:flex;gap:.6rem;flex-wrap:wrap}
.center{display:flex;justify-content:center;align-items:center}

/* Buttons */
.btn{
  display:inline-flex;align-items:center;justify-content:center;
  padding:1rem 1.5rem;border-radius:14px;border:2px solid var(--cyan2);
  background:linear-gradient(180deg,rgba(108,207,255,.25),rgba(108,207,255,.1));
  color:#fff;font-weight:600;font-size:1rem;letter-spacing:.4px;
  box-shadow:0 0 22px rgba(108,207,255,.35);cursor:pointer;transition:all .25s ease
}
.btn:hover{background:linear-gradient(180deg,rgba(108,207,255,.4),rgba(108,207,255,.2));box-shadow:0 0 32px rgba(108,207,255,.55);transform:translateY(-1px)}
.btn.secondary{border-color:#fff4;background:linear-gradient(180deg,rgba(255,255,255,.1),rgba(255,255,255,.05));color:#fff}
.btn.secondary:hover{box-shadow:0 0 26px rgba(255,255,255,.35)}
.tab{color:#fff;font-weight:600;background:rgba(255,255,255,.08);border-radius:12px;border:1px solid #ffffff33;padding:.6rem 1rem;cursor:pointer;transition:all .2s ease}
.tab:hover,.tab.active{background:rgba(255,255,255,.18);box-shadow:0 0 18px rgba(108,207,255,.4)}

/* Hero */
header.hero{min-height:62vh;display:grid;place-items:center;text-align:center;padding:4rem 1rem 2rem}
.hero-inner{max-width:960px}
.logo{
  width:340px;height:340px;border-radius:50%;object-fit:cover;border:3px solid #fff;
  box-shadow:0 0 26px var(--cyan2);transition:transform .4s ease, box-shadow .4s ease;
  animation:pulse 3.2s ease-in-out infinite
}
.logo:hover{transform:scale(1.03) rotate(2deg);box-shadow:0 0 60px var(--cyan)}
@keyframes pulse{0%{transform:scale(1);box-shadow:0 0 18px var(--cyan2)}50%{transform:scale(1.03);box-shadow:0 0 36px var(--cyan)}100%{transform:scale(1);box-shadow:0 0 18px var(--cyan2)}}
h1{font-size:clamp(2.3rem,4vw,3.4rem);margin:.8rem 0 .4rem}
.tag{color:var(--muted);font-size:1.05rem;margin:0 auto 1.1rem;max-width:720px}

/* Copy pill */
.copy{padding:.35rem .55rem;border-radius:9px;border:1px solid #ffffff33;background:#ffffff1a;color:#fff;cursor:pointer}
.notice{font-size:.9rem;color:#bfe2ff}
footer{color:var(--muted);text-align:center;padding:2rem 1rem}
</style>
</head>
<body>

<!-- HERO -->
<header class="hero">
  <div class="hero-inner">
    <img class="logo" src="./wtrcoin.png" alt="Water Token (WTR) coin" />
    <h1>Fountara</h1>
    <p class="tag">Bulk potable water & farm-fresh sod. Pay with <strong>Water Token (WTR)</strong> or <strong>ADA</strong> on Cardano.</p>
    <div class="flex center">
      <a href="#order" class="btn">Start Order</a>
      <a href="#pay" class="btn secondary">Checkout (WTR / ADA)</a>
    </div>
  </div>
</header>

<!-- BRAND STRIP -->
<section class="wrap" style="padding-top:0">
  <div class="token-box" style="display:grid;grid-template-columns:1.2fr .8fr;gap:1rem;align-items:center">
    <div>
      <img src="./Flogo.jpg" alt="Fountara Spring Water"
           style="height:72px;object-fit:contain;filter:drop-shadow(0 0 8px rgba(108,207,255,.25))" />
      <p class="muted" style="margin:.6rem 0 0">
        Delivering potable bulk water and sod across Florida. Crypto-friendly checkout with Water Token (WTR) or ADA.
      </p>
    </div>
    <div style="display:flex;gap:.6rem;justify-content:flex-end;flex-wrap:wrap">
      <img src="./watertanker.png" alt="Fountara water tanker"
           style="height:100px;border-radius:12px;border:1px solid #ffffff22" />
      <img src="./Sodtruck.png" alt="Sod delivery"
           style="height:100px;border-radius:12px;border:1px solid #ffffff22" />
    </div>
  </div>
</section>

<div class="wrap">
  <!-- ORDER BUILDER -->
  <section id="order" class="token-box">
    <h2 class="section-title">Build Your Order</h2>

    <div class="flex" role="tablist">
      <button class="tab active" data-mode="water">Bulk Water</button>
      <button class="tab" data-mode="sod">Sod Pallets</button>
    </div>

    <!-- WATER FORM -->
    <div id="waterForm" style="margin-top:1rem">
      <div class="grid3">
        <label>Tanker Size (gallons)
          <select id="waterSize" class="input">
            <option value="6000">6,000 gal</option>
            <option value="7500" selected>7,500 gal</option>
            <option value="8500">8,500 gal</option>
          </select>
        </label>
        <label># of Loads
          <input id="waterLoads" class="input" type="number" min="1" step="1" value="1" />
        </label>
        <label>Delivery Distance (miles)
          <input id="waterMiles" class="input" type="number" min="0" step="1" value="20" />
        </label>
      </div>

      <div class="grid3" style="margin-top:.6rem">
        <label>Price per Gallon (USD)
          <input id="pricePerGallon" class="input" type="number" step="0.001" value="0.02" />
        </label>
        <label>Delivery per Mile (USD)
          <input id="deliveryPerMile" class="input" type="number" step="0.01" value="4.00" />
        </label>
        <label>Round Trip? (×2)
          <select id="roundTrip" class="input">
            <option value="yes" selected>Yes</option>
            <option value="no">No</option>
          </select>
        </label>
      </div>
    </div>

    <!-- SOD FORM -->
    <div id="sodForm" style="display:none;margin-top:1rem">
      <div class="grid3">
        <label>Grass Type
          <select id="sodType" class="input">
            <option value="st-aug">St. Augustine</option>
            <option value="bahia" selected>Bahia</option>
            <option value="zoysia">Zoysia</option>
          </select>
        </label>
        <label>Pallets
          <input id="sodPallets" class="input" type="number" min="1" value="10" />
        </label>
        <label>Delivery Distance (miles)
          <input id="sodMiles" class="input" type="number" min="0" value="30" />
        </label>
      </div>
      <div class="grid3" style="margin-top:.6rem">
        <label>Price per Pallet (USD)
          <input id="sodPrice" class="input" type="number" step="0.01" value="170" />
        </label>
        <label>Delivery per Mile (USD)
          <input id="sodDelivery" class="input" type="number" step="0.01" value="3.25" />
        </label>
        <label>Pallets per Truck
          <input class="input" value="16" disabled />
        </label>
      </div>
    </div>

    <!-- SUMMARY -->
    <div class="grid2" style="margin-top:1rem">
      <div class="card">
        <h3>Order Summary</h3>
        <div id="summary" class="small">
          <div class="kv"><span>Item</span><strong>—</strong></div>
          <div class="kv"><span>Subtotal</span><strong>$0.00</strong></div>
          <div class="kv"><span>Delivery</span><strong>$0.00</strong></div>
          <div class="kv"><span>Total</span><strong id="orderTotal">$0.00</strong></div>
        </div>
      </div>

      <div class="card">
        <h3>Choose Currency</h3>
        <div class="grid3">
          <label>Pay in:
            <select id="payCurrency" class="input">
              <option value="WTR" selected>Water Token (WTR)</option>
              <option value="ADA">ADA</option>
            </select>
          </label>
          <label>ADA/USD
            <input id="adaUsd" class="input" type="number" step="0.0001" value="0.40" />
          </label>
          <label>WTR/ADA
            <input id="wtrAda" class="input" type="number" step="0.0000001" value="0.00001" />
          </label>
        </div>
        <div class="small" id="payBreakdown" style="margin-top:.6rem">—</div>
        <div class="flex" style="margin-top:.6rem">
          <a href="#pay" class="btn">Go to Checkout</a>
          <button id="recalcBtn" class="btn secondary">Recalculate</button>
        </div>
      </div>
    </div>
  </section>

  <!-- CHECKOUT -->
  <section id="pay" class="token-box">
    <h2 class="section-title">Checkout (WTR / ADA)</h2>
    <div style="display:flex;gap:.8rem;align-items:center;margin:.2rem 0 1rem">
      <img src="./wtrcoin.png" alt="WTR coin" style="height:56px;width:56px;border-radius:50%;border:1px solid #ffffff33" />
      <div class="muted">Send the exact amount shown. Include your order reference for fastest scheduling.</div>
    </div>

    <div class="grid3">
      <div>
        <strong>Connect Cardano Wallet</strong><br />
        <button class="btn" id="btnNami">Connect Nami</button>
        <button class="btn secondary" id="btnEternl">Connect Eternl</button>
        <div id="walletStatus" class="muted small">Not connected</div>
      </div>

      <div>
        <strong>Fountara Receive Address</strong>
        <div class="small muted">Where to send WTR or ADA.</div>
        <div class="flex" style="align-items:center">
          <code id="recvAddress" style="background:#0006;padding:.4rem .6rem;border-radius:10px">addr1qyourfountaraaddressxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code>
          <button class="copy" data-copy="recvAddress">Copy</button>
        </div>
      </div>

      <div>
        <strong>Order Reference</strong>
        <div class="small muted">Paste this in your message so we can match your payment quickly.</div>
        <div class="flex" style="align-items:center">
          <code id="orderRef" style="background:#0006;padding:.4rem .6rem;border-radius:10px"></code>
          <button class="copy" data-copy="orderRef">Copy</button>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:1rem">
      <h3>Amount to Send</h3>
      <div class="grid3">
        <div class="kv"><span>Currency</span><strong id="ckCurrency">WTR</strong></div>
        <div class="kv"><span>Amount</span><strong id="ckAmount">—</strong></div>
        <div class="kv"><span>USD Est.</span><strong id="ckUsd">—</strong></div>
      </div>
    </div>
  </section>

  <footer>© Fountara — Bulk Water • Sod • Crypto-ready checkout</footer>
</div>
<script>
// ---------- Small helpers ----------
const fmtUSD = n => Number(n||0).toLocaleString(undefined,{style:'currency',currency:'USD',maximumFractionDigits:2});
const fmtNum = (n,d=6)=> Number(n||0).toLocaleString(undefined,{maximumFractionDigits:d});
const el = id => document.getElementById(id);
const short = s => s ? (s.length>18? s.slice(0,6)+'…'+s.slice(-6): s) : '';

// ---------- Elements ----------
const tabs = document.querySelectorAll('[data-mode]');
const waterForm = el('waterForm');
const sodForm   = el('sodForm');

// WATER inputs
const waterSize = el('waterSize');
const waterLoads= el('waterLoads');
const waterMiles= el('waterMiles');
const pricePerGallon = el('pricePerGallon');
const deliveryPerMile = el('deliveryPerMile');
const roundTrip = el('roundTrip');

// SOD inputs
const sodType   = el('sodType');
const sodPallets= el('sodPallets');
const sodMiles  = el('sodMiles');
const sodPrice  = el('sodPrice');
const sodDelivery = el('sodDelivery');

// Currency inputs
const payCurrency = el('payCurrency');
const adaUsd = el('adaUsd');
const wtrAda = el('wtrAda');

// Summary/checkout outputs
const summary = el('summary');
const orderTotalEl = el('orderTotal');
const payBreakdown = el('payBreakdown');
const ckCurrency = el('ckCurrency');
const ckAmount = el('ckAmount');
const ckUsd = el('ckUsd');
const orderRef = el('orderRef');

// ---------- Tab switching (FIXED) ----------
tabs.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabs.forEach(x=>x.classList.remove('active'));
    btn.classList.add('active');
    const mode = btn.getAttribute('data-mode');
    // Toggle forms
    const isWater = (mode === 'water');
    waterForm.style.display = isWater ? '' : 'none';
    sodForm.style.display   = isWater ? 'none' : '';
    // Recalculate with current form
    recalc();
  });
});

// ---------- Default price per grass (edit to your market) ----------
const GRASS_DEFAULTS = {
  'bahia':      170,  // per pallet USD
  'st-aug':     260,
  'zoysia':     280
};
sodType.addEventListener('change', ()=>{
  const v = sodType.value;
  if (GRASS_DEFAULTS[v]) {
    sodPrice.value = GRASS_DEFAULTS[v];
  }
  recalc();
});

// ---------- Recalculate ----------
function recalc(){
  // Which tab is active?
  const active = document.querySelector('[data-mode].active');
  const mode = active ? active.getAttribute('data-mode') : 'water';

  let itemLabel = '';
  let subtotal = 0;
  let delivery = 0;

  if (mode==='water'){
    const size = Number(waterSize.value||0);
    const loads= Number(waterLoads.value||0);
    const miles= Number(waterMiles.value||0);
    const ppg  = Number(pricePerGallon.value||0);
    const dpm  = Number(deliveryPerMile.value||0);
    const rt   = (roundTrip.value==='yes') ? 2 : 1;

    const gallons = size * loads;
    subtotal = gallons * ppg;
    delivery = miles * rt * dpm * loads;
    itemLabel = `${loads}× tanker (${fmtNum(size,0)} gal)`;
  } else {
    const pallets = Number(sodPallets.value||0);
    const miles = Number(sodMiles.value||0);
    const pp    = Number(sodPrice.value||0);
    const dpm   = Number(sodDelivery.value||0);

    subtotal = pallets * pp;
    delivery = miles * dpm;
    const typeLabel = sodType.options[sodType.selectedIndex]?.textContent || 'Sod';
    itemLabel = `${fmtNum(pallets,0)} pallets (${typeLabel})`;
  }

  const total = subtotal + delivery;
  orderTotalEl.textContent = fmtUSD(total);
  summary.innerHTML = `
    <div class="kv"><span>Item</span><strong>${itemLabel}</strong></div>
    <div class="kv"><span>Subtotal</span><strong>${fmtUSD(subtotal)}</strong></div>
    <div class="kv"><span>Delivery</span><strong>${fmtUSD(delivery)}</strong></div>
    <div class="kv"><span><em>Estimated Total</em></span><strong>${fmtUSD(total)}</strong></div>
  `;

  // Payment math (editable inputs for simple offline pricing)
  const currency = payCurrency.value;      // WTR or ADA
  const ada_per_usd = Number(adaUsd.value||0.4);     // ADA price in USD
  const wtr_per_ada = Number(wtrAda.value||0.00001); // WTR per ADA

  let sendAmount = 0, usdEst = total;

  if (currency==='ADA'){
    // USD -> ADA
    sendAmount = (total / ada_per_usd);
    payBreakdown.textContent = `You’ll send ≈ ${fmtNum(sendAmount,4)} ADA (at ${fmtNum(ada_per_usd,4)} USD/ADA).`;
  } else {
    // USD -> ADA -> WTR
    const adaNeeded = (total / ada_per_usd);
    sendAmount = (adaNeeded / wtr_per_ada);
    payBreakdown.textContent = `You’ll send ≈ ${fmtNum(sendAmount,0)} WTR (via ${fmtNum(adaNeeded,4)} ADA × ${fmtNum(1/wtr_per_ada,0)} WTR/ADA).`;
  }

  ckCurrency.textContent = currency;
  ckAmount.textContent = (currency==='ADA') ? `${fmtNum(sendAmount,4)} ADA` : `${fmtNum(sendAmount,0)} WTR`;
  ckUsd.textContent = fmtUSD(usdEst);

  // Fresh order reference each calc
  const code = 'FO-' + new Date().toISOString().replaceAll(':','').replaceAll('-','').slice(0,15)
             + '-' + Math.random().toString(36).slice(2,6).toUpperCase();
  orderRef.textContent = code;
}

// Bind input changes
[
  waterSize,waterLoads,waterMiles,pricePerGallon,deliveryPerMile,roundTrip,
  sodType,sodPallets,sodMiles,sodPrice,sodDelivery,
  payCurrency,adaUsd,wtrAda
].forEach(x=> x.addEventListener('input', recalc));
el('recalcBtn')?.addEventListener('click', recalc);

// ---------- Copy buttons ----------
document.querySelectorAll('.copy').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const id = btn.getAttribute('data-copy');
    const text = el(id).textContent.trim();
    navigator.clipboard.writeText(text).then(()=>{
      btn.textContent = 'Copied!';
      setTimeout(()=>btn.textContent='Copy', 1000);
    });
  });
});

// ---------- Cardano wallet connect (simple CIP-30) ----------
const walletStatus = el('walletStatus');
async function connectCardano(which){
  try{
    if(!(window.cardano && window.cardano[which])){ walletStatus.textContent = which.toUpperCase()+': not found'; return; }
    const api = await window.cardano[which].enable();
    const net = await api.getNetworkId(); if (net !== 1){ walletStatus.textContent = which.toUpperCase()+': wrong network'; return; }
    const changeAddr = await api.getChangeAddress();
    walletStatus.textContent = which.toUpperCase()+': '+ short(changeAddr);
  }catch(e){ walletStatus.textContent = which.toUpperCase()+': failed'; }
}
document.getElementById('btnNami')?.addEventListener('click', ()=>connectCardano('nami'));
document.getElementById('btnEternl')?.addEventListener('click', ()=>connectCardano('eternl'));

// ---------- Set your real receive address here ----------
el('recvAddress').textContent = 'addr1qyourfountaraaddressxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';

// Initial paint
recalc();
</script>

